{% extends 'base.html' %}
{% block content %}

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
.invoice-wrapper{
    max-width:850px;
    margin:40px auto;
    background:#fff;
    padding:40px;
    font-family: Arial, Helvetica, sans-serif;
    color:#333;
    border:1px solid #eee;
}
.invoice-header{
    display:flex;
    justify-content:space-between;
    border-bottom:2px solid #c9a227;
    padding-bottom:15px;
}
.company-name{
    font-size:32px;
    font-weight:bold;
    color:#c9a227;
}
.invoice-title{
    font-size:28px;
    font-weight:bold;
}
.meta{
    margin-top:10px;
    font-size:14px;
}
.bill-to{
    margin-top:25px;
    font-size:14px;
}
.invoice-table{
    width:100%;
    margin-top:30px;
    border-collapse:collapse;
}
.invoice-table th{
    background:#f5f5f5;
    text-align:left;
    padding:10px;
}
.invoice-table td{
    padding:10px;
    border-bottom:1px solid #ddd;
}
.invoice-total{
    text-align:right;
    font-size:18px;
    font-weight:bold;
    color:#c9a227;
}
.footer{
    margin-top:40px;
    text-align:center;
    font-size:13px;
    color:#777;
}
.sign{
    text-align:right;
    margin-top:30px;
    font-weight:bold;
}
.action-buttons{
    text-align:center;
    margin:30px 0;
}
.btn{
    padding:12px 25px;
    border-radius:30px;
    border:none;
    cursor:pointer;
    margin:5px;
    font-weight:bold;
}
.btn-print{ background:#222;color:#fff;}
.btn-pdf{ background:#c9a227;color:#000;}
.btn-wa{ background:#25D366;color:#fff;}

@media print{
    .action-buttons{display:none;}
}
</style>

<div id="invoice" class="invoice-wrapper">

    <div class="invoice-header">
        <div>
            <div class="company-name">A1 Bakery</div>
            Malegaon, Maharashtra<br>
            Phone: +91 8421857457
        </div>
        <div style="text-align:right">
            <div class="invoice-title">INVOICE</div>
            <div class="meta">
                Order #: {{ order.id }}<br>
                Date: {% now "jS F Y" %}
            </div>
        </div>
    </div>

    <div class="bill-to">
        <strong>Bill To:</strong><br>
        {{ order.customer_name }}<br>
        {{ order.customer_phone }}<br>
        {{ order.address }}, {{ order.city }}
    </div>

    <table class="invoice-table">
        <tr>
            <th>Item Description</th>
            <th>Qty</th>
            <th style="text-align:right">Price</th>
            <th style="text-align:right">Total</th>
        </tr>
        <tr>
            <td>{{ order.product.name }}</td>
            <td>{{ order.quantity }}</td>
            <td style="text-align:right">₹{{ order.product.price }}</td>
            <td style="text-align:right">
                ₹{% widthratio order.product.price 1 order.quantity %}
            </td>
        </tr>
        <tr>
            <td colspan="3" class="invoice-total">Total Amount:</td>
            <td class="invoice-total">
                ₹{% widthratio order.product.price 1 order.quantity %}
            </td>
        </tr>
    </table>

    <div class="footer">
        Thank you for choosing A1 Bakery!
        <div class="sign">
            Authorized Signatory<br>
            A1 Bakery
        </div>
    </div>
</div>

<div class="action-buttons">
    <button onclick="window.print()" class="btn btn-print">Print</button>
    <button onclick="downloadPDF()" class="btn btn-pdf">Download PDF</button>
    <a class="btn btn-wa"
       target="_blank"
       href="https://wa.me/918421857457?text=Invoice%20for%20Order%20%23{{ order.id }}">
       WhatsApp
    </a>
</div>

<script>
function downloadPDF(){
    html2pdf().from(document.getElementById('invoice')).set({
        filename:'A1_Bakery_Invoice_{{ order.id }}.pdf',
        html2canvas:{scale:2},
        jsPDF:{unit:'in',format:'letter',orientation:'portrait'}
    }).save();
}
</script>

{% endblock %}
